version: "3"
services:
  api:
   build:
    context: .
    dockerfile: ./api/
   restart: unless-stopped
# Данный сервис не запуститься вместе с остальными, для его запуска нужно указать на его профиль. docker-compose --profile backend up 
   profiles:
     - "backend"
   container_name: api
   volumes:
     - ./.env:/opt/app/.env
   networks:
    - myNetwork
   depends_on:
     - rmq
  rmq:
   image: rabbitmq:3-management
   restart: unless-stopped
# docker-compose --profile backend --profile queue up -d
   profiles:
     - "queue"
   networks:
    - myNetwork
   env_file: 
     - .env
   environment:
    - RABBITMQ_DEFAULT_USER=admin
    - RABBITMQ_DEFAULT_PASSWORD=admin

networks:
  myNetwork:
   driver: bridge